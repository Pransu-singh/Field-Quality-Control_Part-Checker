<!-- ✅ FQC-DEWAS Search Form -->
<form method="POST" class="row g-3 mb-3">
  <input type="hidden" name="search_type" value="qr1">

  <div class="col-md-4">
    <input type="text" name="serial_no" class="form-control" placeholder="Search by Serial Number" value="{{ request.form.serial_no }}">
  </div>
  <div class="col-md-4">
    <input type="text" name="set_no" class="form-control" placeholder="Search by Set Number" value="{{ request.form.set_no }}">
  </div>
  <div class="col-md-4">
    <input type="text" name="id_no" class="form-control" placeholder="Search by ID Number" value="{{ request.form.id_no }}">
  </div>
  <div class="col-12 text-end">
    <button class="btn btn-primary" type="submit">
      <i class="fas fa-eye me-2"></i>View
    </button>
  </div>
</form>

<!-- ✅ Show download buttons and result table if results exist -->
{% if qr1_results %}
<div class="mb-4 d-flex gap-2 flex-wrap">
  <form method="POST" action="{{ url_for('download_search_pdf') }}">
    <input type="hidden" name="serial_no" value="{{ request.form.serial_no }}">
    <input type="hidden" name="set_no" value="{{ request.form.set_no }}">
    <input type="hidden" name="id_no" value="{{ request.form.id_no }}">
    <button class="btn btn-danger">
      <i class="fas fa-file-pdf me-2"></i>Download PDF
    </button>
  </form>

  <form method="POST" action="{{ url_for('download_search_csv') }}">
    <input type="hidden" name="serial_no" value="{{ request.form.serial_no }}">
    <input type="hidden" name="set_no" value="{{ request.form.set_no }}">
    <input type="hidden" name="id_no" value="{{ request.form.id_no }}">
    <button class="btn btn-success">
      <i class="fas fa-file-csv me-2"></i>Download CSV
    </button>
  </form>
</div>

<!-- ✅ Results Table -->
<div class="table-responsive">
  <table class="table table-sm table-bordered table-striped text-center align-middle">
    <thead class="table-primary">
      <tr>
        <th>Username</th>
        <th>User Type</th>
        <th>Timestamp</th>
        <th>Unit</th>
        <th>Location</th>
        <th>Shift</th>
        <th>Crown Scan</th>
        <th>Pinion Scan</th>
        <th>Crown ID</th>
        <th>Pinion ID</th>
        <th>Crown Set</th>
        <th>Pinion Set</th>
        <th>ED No</th>
        <th>Repeat No</th>
        <th>Set Match</th>
        <th>Part Match</th>
        <th>Overall Status</th>
      </tr>
    </thead>
    <tbody>
      {% for row in qr1_results %}
      <tr>
        <td>{{ row.username }}</td>
        <td>{{ row.user_type }}</td>
        <td>{{ row.timestamp }}</td>
        <td>{{ row.unit }}</td>
        <td>{{ row.location }}</td>
        <td>{{ row.shift }}</td>
        <td>{{ row.crown_scan }}</td>
        <td>{{ row.pinion_scan }}</td>
        <td>{{ row.crown_id_no }}</td>
        <td>{{ row.pinion_id_no }}</td>
        <td>{{ row.crown_set_no }}</td>
        <td>{{ row.pinion_set_no }}</td>
        <td>{{ row.ed_no }}</td>
        <td>{{ row.repeat_no }}</td>
        <td>{{ row.set_match }}</td>
        <td>{{ row.part_match }}</td>
        <td>{{ row.overall_status }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% elif request.method == 'POST' %}
<div class="alert alert-warning text-center">No data found for FQC-DEWAS search.</div>
{% endif %}


